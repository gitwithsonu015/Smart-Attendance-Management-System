{"ast":null,"code":"const express = require('express');\nconst bcrypt = require('bcryptjs');\nconst jwt = require('jsonwebtoken');\nconst Student = require('../models/Student');\nconst Faculty = require('../models/Faculty');\nconst router = express.Router();\n\n// Register Student\nrouter.post('/register/student', async (req, res) => {\n  const {\n    name,\n    email,\n    password,\n    rollNumber,\n    class: studentClass\n  } = req.body;\n  try {\n    const hashedPassword = await bcrypt.hash(password, 10);\n    const student = new Student({\n      name,\n      email,\n      password: hashedPassword,\n      rollNumber,\n      class: studentClass\n    });\n    await student.save();\n    res.status(201).json({\n      message: 'Student registered successfully'\n    });\n  } catch (err) {\n    res.status(400).json({\n      error: err.message\n    });\n  }\n});\n\n// Register Faculty\nrouter.post('/register/faculty', async (req, res) => {\n  const {\n    name,\n    email,\n    password,\n    department\n  } = req.body;\n  try {\n    const hashedPassword = await bcrypt.hash(password, 10);\n    const faculty = new Faculty({\n      name,\n      email,\n      password: hashedPassword,\n      department\n    });\n    await faculty.save();\n    res.status(201).json({\n      message: 'Faculty registered successfully'\n    });\n  } catch (err) {\n    res.status(400).json({\n      error: err.message\n    });\n  }\n});\n\n// Login\nrouter.post('/login', async (req, res) => {\n  const {\n    email,\n    password,\n    role\n  } = req.body;\n  try {\n    let user;\n    if (role === 'student') {\n      user = await Student.findOne({\n        email\n      });\n    } else {\n      user = await Faculty.findOne({\n        email\n      });\n    }\n    if (!user) return res.status(400).json({\n      error: 'User not found'\n    });\n    const isMatch = await bcrypt.compare(password, user.password);\n    if (!isMatch) return res.status(400).json({\n      error: 'Invalid credentials'\n    });\n    const token = jwt.sign({\n      id: user._id,\n      role\n    }, process.env.JWT_SECRET);\n    res.json({\n      token,\n      user\n    });\n  } catch (err) {\n    res.status(500).json({\n      error: err.message\n    });\n  }\n});\nmodule.exports = router;","map":{"version":3,"names":["express","require","bcrypt","jwt","Student","Faculty","router","Router","post","req","res","name","email","password","rollNumber","class","studentClass","body","hashedPassword","hash","student","save","status","json","message","err","error","department","faculty","role","user","findOne","isMatch","compare","token","sign","id","_id","process","env","JWT_SECRET","module","exports"],"sources":["C:/Users/HP/Desktop/smart attendance/client/src/routes/auth.js"],"sourcesContent":["const express = require('express');\r\nconst bcrypt = require('bcryptjs');\r\nconst jwt = require('jsonwebtoken');\r\nconst Student = require('../models/Student');\r\nconst Faculty = require('../models/Faculty');\r\n\r\nconst router = express.Router();\r\n\r\n// Register Student\r\nrouter.post('/register/student', async (req, res) => {\r\n  const { name, email, password, rollNumber, class: studentClass } = req.body;\r\n  try {\r\n    const hashedPassword = await bcrypt.hash(password, 10);\r\n    const student = new Student({ name, email, password: hashedPassword, rollNumber, class: studentClass });\r\n    await student.save();\r\n    res.status(201).json({ message: 'Student registered successfully' });\r\n  } catch (err) {\r\n    res.status(400).json({ error: err.message });\r\n  }\r\n});\r\n\r\n// Register Faculty\r\nrouter.post('/register/faculty', async (req, res) => {\r\n  const { name, email, password, department } = req.body;\r\n  try {\r\n    const hashedPassword = await bcrypt.hash(password, 10);\r\n    const faculty = new Faculty({ name, email, password: hashedPassword, department });\r\n    await faculty.save();\r\n    res.status(201).json({ message: 'Faculty registered successfully' });\r\n  } catch (err) {\r\n    res.status(400).json({ error: err.message });\r\n  }\r\n});\r\n\r\n// Login\r\nrouter.post('/login', async (req, res) => {\r\n  const { email, password, role } = req.body;\r\n  try {\r\n    let user;\r\n    if (role === 'student') {\r\n      user = await Student.findOne({ email });\r\n    } else {\r\n      user = await Faculty.findOne({ email });\r\n    }\r\n    if (!user) return res.status(400).json({ error: 'User not found' });\r\n\r\n    const isMatch = await bcrypt.compare(password, user.password);\r\n    if (!isMatch) return res.status(400).json({ error: 'Invalid credentials' });\r\n\r\n    const token = jwt.sign({ id: user._id, role }, process.env.JWT_SECRET);\r\n    res.json({ token, user });\r\n  } catch (err) {\r\n    res.status(500).json({ error: err.message });\r\n  }\r\n});\r\n\r\nmodule.exports = router;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}